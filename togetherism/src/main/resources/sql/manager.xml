<?xml version="1.0" encoding="UTF-8" ?>
 <!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="managerns">
	
	<!-- 관리자 1명의 정보 가져오기 -->
	<select id="getManager" resultType="manager">
		select * from manager where manager_email = #{manager_email,jdbcType=VARCHAR}	
	</select>
	
	<!-- 관리자 전체 정보 가져오기 -->
	<select id="getManagerlist" parameterType="String" resultType="manager">
		select * from manager
	</select>
	
	<!-- 전체 회원의 수 -->
	<select id="memberCount" resultType="int">
		select count (*) from member
	</select>
	
	<!-- 전체 회원 목록 가져오기  -->
	<select id="memberList" parameterType="int" resultType="member">
		<![CDATA[
		select * from (select rownum rnum, member.* from (
		select * from member order by member_reg_date desc) member )
		where rnum >= ((#{page} - 1) * 10 + 1 ) and rnum <= (#{page} * 10)
		]]>
	</select>
	
	<!-- 이메일, 닉네임 검색 목록 가져오기 -->
	<select id="getSearch" resultType="member">
		select * from member
		<where>
			<if test="keyword != null and search != null">
				${search} like '%'||#{keyword}||'%'
			</if>
		</where>
	</select>
	
	<!-- 현재 활동중인 회원의 수 -->
	<select id="nowMember" resultType="int">
		select count(member_del_yn) from member where member_del_yn = 'N'
	</select>
	
	<!-- 현재 활동중인 회원 목록 가져오기  -->
	<select id="nowmemberList" parameterType="int" resultType="member">
		<![CDATA[
		select * from (select rownum rnum, member.* from (
		select * from member where member_del_yn = 'N' order by member_reg_date desc) member )
		where rnum >= ((#{page} - 1) * 10 + 1 ) and rnum <= (#{page} * 10)
		]]>
	</select>
	
	<!-- 특정 회원 1명의 정보 가져오기 -->
	<select id="getMember" parameterType="int" resultType="member">
		select * from member where member_email = #{member_email}
	</select>
	
	<!-- 특정 회원 1명의 신고 횟수 가져오기 -->
	<select id="reportCount" resultType="int">
		select count (*) from report where member_email= #{member_email}
	</select>
	
	<!-- 특정 회원의 모임장 리스트 가져오기 -->
	<select id="getClub" resultType="club">
		select * from club where club_host_email = #{member_email}
	</select>
	
	<!-- 특정 회원 강제 탈퇴 -->
	<update id="memberDelete" parameterType="member">
		update member set member_del_yn = 'Y', member_del_date = sysdate,
		member_del_reason = #{member_del_reason} where member_email = #{member_email}
	</update>
	

</mapper>